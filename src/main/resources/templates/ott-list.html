<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>OTT 플랫폼 목록</title>
</head>
<body>
  <h1>OTT 플랫폼 목록</h1>

  <!-- 구독 완료 알림 -->
  <div th:if="${subscribeSuccess}">
    <script>alert('신청이 완료되었습니다.');</script>
  </div>

  <!-- userno는 로그인 시만 주입됨 -->
  <script th:inline="javascript">
    /*<![CDATA[*/
    var userno = /*[[${userno}]]*/ null;
    /*]]>*/
  </script>

  <div th:each="ott : ${ottList}">
    <p><strong th:text="${ott.otype}">플랫폼명</strong></p>

    <form th:if="${userno != null}"
          th:action="@{'/ott/' + ${userno} + '/subscribe'}"
          method="post">
      <input type="hidden" name="ottId" th:value="${ott.ottNo}" />
      <button type="submit">구독</button>
    </form>

    <form th:if="${userno == null}" action="/login" method="get">
      <button type="submit">로그인 후 구독하기</button>
    </form>
  </div>

</body>
</html>
